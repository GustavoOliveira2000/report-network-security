\PassOptionsToPackage{usenames,dvipsnames,table}{xcolor}
\documentclass[sigconf,balance,nonacm]{acmart}

% packages
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{commath}
\usepackage{graphicx}
\usepackage[caption=false,font=footnotesize]{subfig}
\usepackage{cleveref}
\usepackage{algorithm,algpseudocode}
\usepackage{specs}
\usepackage{soul}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage[nolist,nohyperlinks]{acronym}
\usepackage{xspace}
\usepackage{url}
\usepackage{pgfplots}
\usepackage{tabularx}
\usepackage{float} 
\pgfplotsset{width=10cm,compat=1.9} 

% title and authors
\title{EUDI Wallet: eIDAS 2.0 and Architecture Reference Framework (ARF) v2.6.0}

\author{Guilherme Coelho}
\author{Gustavo Oliveira}
\author{Pedro Galvão}

\begin{abstract}
The European Digital Identity Wallet represents a transformative initiative in digital identity management, establishing a unified framework for secure, privacy-preserving, and interoperable identity services across the European Union. Governed by the eIDAS 2.0 Regulation (EU 2024/1183) and operationalized through the Architecture and Reference Framework (ARF) v2.6.0, the EUDI Wallet synthesizes Self-Sovereign Identity principles with institutional trust mechanisms to empower citizens with unprecedented control over their personal data. This report focuses on a component-level evaluation of the ARF and on the conceptual design of a pilot implementation, analysing how identity verification, privacy safeguards, and interoperability mechanisms support concrete digital identity transactions in practice.
\end{abstract}

\keywords{European Digital Identity Wallet, eIDAS 2.0, Architecture and Reference Framework, Digital Identity, Interoperability, Privacy-by-Design}

\begin{document}

% acronyms
\begin{acronym}
    \acro{ARF}{Architecture and Reference Framework}
    \acro{CAB}{Conformity Assessment Body}
    \acro{DID}{Decentralized Identifier}
    \acro{DPIA}{Data Protection Impact Assessment}
    \acro{EAA}{Electronic Attestation of Attributes}
    \acro{EUDI}{European Digital Identity}
    \acro{GDPR}{General Data Protection Regulation}
    \acro{LoA}{Level of Assurance}
    \acro{mdoc}{Mobile Document}
    \acro{MFA}{Multi-Factor Authentication}
    \acro{NFC}{Near Field Communication}
    \acro{PET}{Privacy-Enhancing Technology}
    \acro{PID}{Person Identification Data}
    \acro{QEAA}{Qualified Electronic Attestation of Attributes}
    \acro{QES}{Qualified Electronic Signature}
    \acro{QTSP}{Qualified Trust Service Provider}
    \acro{SD-JWT}{Selective Disclosure JSON Web Token}
    \acro{SSI}{Self-Sovereign Identity}
    \acro{TEE}{Trusted Execution Environment}
    \acro{WSCA}{Wallet Secure Cryptographic Application}
    \acro{WSCD}{Wallet Secure Cryptographic Device}
    \acro{ZKP}{Zero-Knowledge Proof}
    \end{acronym}

\maketitle

% % % % % % % % % % % % % % % % % % % % %
%              INTRODUCTION
% % % % % % % % % % % % % % % % % % % % %
\section{Introduction}
\label{sec:intro}

The goal of this project is to investigate which specific components of the European Digital Identity Wallet \ac{ARF} effectively support digital identity transactions under the eIDAS 2.0 framework. 
Rather than providing another broad, descriptive overview of the ecosystem, this work narrows its focus to two complementary tasks:

\begin{itemize}
    \item a \emph{component evaluation} of key architectural building blocks that enable secure identification, privacy-preserving attribute exchange, and cross-border interoperability; and
    \item a \emph{pilot design} that illustrates, at a high level, how those components can be orchestrated in a concrete use case.
\end{itemize}

In particular, we analyse:
(i) how identity verification and authentication are realised across different Levels of Assurance (\ac{LoA}),
(ii) how data minimisation and consent management mechanisms contribute to \ac{GDPR} compliance,
and (iii) which interoperability mechanisms allow national identity systems and sectoral services to interact smoothly while sharing a common architectural baseline.

Building on this analysis, we then propose a minimally functional pilot design for a specific use case, describing the actors involved, the flow of credentials and trust, and the way architectural principles from the \ac{ARF} are applied in practice.

\subsection{Structure of the Report}

The remainder of this report is structured as follows.
Section~\ref{sec:components} presents the component evaluation, organised around identity verification and authentication, privacy safeguards, and interoperability mechanisms.
Section~\ref{sec:pilot} introduces a high-level pilot design for a chosen use case, mapping the components analysed in Section~\ref{sec:components} to a practical flow of identity and trust.
Section~\ref{sec:conclusion} concludes the report with a short reflection on the strengths and limitations of the \ac{ARF} in supporting real-world deployments.

% % % % % % % % % % % % % % % % % % % % %
%           COMPONENT EVALUATION
% % % % % % % % % % % % % % % % % % % % %
\section{Component Evaluation}
\label{sec:components}

The \ac{ARF} defines a set of technical and organisational components that work together to support digital identity transactions, from initial identity proofing to the presentation of attributes to Relying Parties.
In this section, we evaluate those components along three dimensions explicitly required by the assignment: identity verification and authentication, data minimisation and consent management, and interoperability mechanisms.

\subsection{Identity Verification and Authentication}

Identity verification and authentication within the EUDI Wallet ecosystem are governed by the regulatory framework established by the revised eIDAS 2.0 Regulation (EU 2024/1183) and operationalized through the Architecture and Reference Framework (ARF) v2.6.0. The regulatory foundation recognizes three Levels of Assurance (LoA)—\emph{low}, \emph{substantial}, and \emph{high}—as originally defined in Article~8 of the eIDAS Regulation and maintained under the updated framework~\cite{EU_eIDAS2024}. These levels categorize the degree of confidence in the asserted identity and the robustness of the corresponding authentication mechanisms. Although all three levels remain legally recognized, the ARF consistently targets \textbf{LoA High} as the baseline for Wallet operations, reflecting the need for a secure, cross-border digital identity infrastructure capable of supporting sensitive use cases across both public and private sectors~\cite{EU_ARF2024}.

\subsubsection*{Identity Proofing}

In the EUDI architecture, LoA High requirements span the entire lifecycle of identity creation, credential issuance, storage, and presentation. Identity proofing during the issuance of Person Identification Data (PID) is conducted by PID Providers on the basis of authoritative registers, adhering to the verification procedures defined in ARF Sections~4.3.1 and~5.4.1~\cite{EU_ARF2024}. The identity of the Holder must be verified using in-person or equivalent high-assurance remote onboarding methods, ensuring that the PID reflects authentic civil identity information. Similarly, Qualified Electronic Attestations of Attributes (QEAAs) issued by Qualified Trust Service Providers (QTSPs) must meet the high-assurance obligations of eIDAS 2.0, particularly Articles~24–26, which mandate strong identity verification prior to the issuance of qualified credentials~\cite{EU_eIDAS2024}.

\subsubsection*{MFA and Strong User Authentication}

To maintain LoA High beyond the issuance phase, the ARF requires that the EUDI Wallet implement \emph{Strong User Authentication} (SUA), a mechanism essentially aligned with multi-factor authentication (MFA). As defined in ARF Section~5.2~\cite{EU_ARF2024}, authentication to the Wallet Instance must rely on at least two independent authentication factors, combining elements such as knowledge (PIN or password), possession (the Wallet Secure Cryptographic Device, WSCD), and inherence (biometric verification processed within a secure hardware enclave). By binding user authentication to the cryptographic capabilities of the WSCD and preventing exposure of biometric or secret material outside secure execution environments, the architecture satisfies both LoA High and GDPR privacy requirements~\cite{EU_eIDAS2024}.

\subsubsection*{Cryptographic Binding Between Credential and WSCD Key}

A central element of assurance is the \emph{cryptographic binding} between the issued credential and the Holder’s WSCD key. ARF Section~4.1.2 mandates that private keys used for credential binding and authentication must be generated, stored, and used exclusively within a certified Secure Element or Trusted Execution Environment~\cite{EU_ARF2024}. This ensures that credentials cannot be transferred, cloned, or exported to unauthorized devices, and provides strong cryptographic guarantees of non-repudiation and Holder control. Bindings are verified during both credential issuance (OpenID4VCI flows) and presentation (OpenID4VP), ensuring continuity of trust across all protocol stages.

\subsubsection*{Mutual Authentication Between Wallet and Verifier}

The EUDI architecture requires that Wallet Units and Relying Parties perform \emph{mutual authentication} prior to any exchange of PID or (Q)EAA data. As described in ARF Section~5.6.1.3~\cite{EU_ARF2024}, presentation flows must establish a mutually authenticated secure channel, enabling the Wallet to verify that the Relying Party is legitimate, registered, and authorized to request specific attributes, while simultaneously allowing the Relying Party to confirm the authenticity and certification status of the Wallet Unit. This bidirectional trust mechanism prevents impersonation attacks and supports robust access control aligned with Article~5a of eIDAS 2.0~\cite{EU_eIDAS2024}.

\subsubsection*{Session Security and Replay Prevention}

Session-level protections complement these measures. The ARF mandates that all online sessions use confidentiality- and integrity-protected communication channels (e.g., TLS with modern cipher suites), and that protocol messages incorporate replay-prevention techniques such as nonces, timestamps, and Holder-specific proofs of possession. These requirements, present throughout ARF Sections~5.6~\cite{EU_ARF2024}, ensure that intercepted or delayed messages cannot be reused to impersonate the Holder or trick Relying Parties into accepting stale presentations.

To illustrate the architectural components that collectively support LoA High, the following simplified diagram aggregates their interactions:
\begin{table}[H]
    \centering
    \small
    \begin{tabularx}{\columnwidth}{>{\bfseries}l X}
    \toprule
    \multicolumn{2}{c}{\textbf{LoA High Assurance Stack}} \\
    \midrule
    Identity Proofing &
    PIDP/QTSP verify identity using authoritative registers
    (\textit{ARF 4.3.1, 5.4.1}). \\
    
    Strong User Authentication &
    MFA + biometrics in secure hardware; WSCD enforces factor
    isolation (\textit{ARF 5.2}). \\
    
    Cryptographic Binding &
    Keys generated and stored inside the WSCD; credentials
    cryptographically bound to the device key (\textit{ARF 4.1.2}). \\
    
    Mutual Authentication &
    Wallet \(\leftrightarrow\) Relying Party verification; authorised RP
    discovery (\textit{ARF 5.6.1.3}). \\
    
    Session Security &
    TLS, nonces, replay-prevention; proof-of-possession per session
    (\textit{ARF 5.6}). \\
    \bottomrule
    \end{tabularx}
    \caption{LoA High assurance components in the EUDI Wallet.}
    \label{tab:loa-high}
\end{table}

In summary, the ARF and eIDAS 2.0 jointly define a high-assurance authentication and verification model centered on rigorous identity proofing, secure hardware-backed cryptography, multi-factor authentication, mutual verification of parties, and robust replay-resistant session semantics. The result is an end-to-end trust framework purpose-built for secure, privacy-preserving digital identity in the European Union~\cite{EU_ARF2024,EU_eIDAS2024}. jointly define a high-assurance authentication and verification model centered on rigorous identity proofing, secure hardware-backed cryptography, multi-factor authentication, mutual verification of parties, and robust replay-resistant session semantics. The result is an end-to-end trust framework purpose-built for secure, privacy-preserving digital identity in the European Union~\cite{EU_ARF2024,EU_eIDAS2024}.


\subsection{Data Minimisation and Consent Management}
\label{subsec:data_minimisation}

Data minimisation, a cornerstone principle of the General Data Protection Regulation (GDPR), requires that personal data be adequate, relevant, and limited to what is necessary in relation to the purposes for which they are processed. The \ac{ARF} operationalises this principle through selective disclosure mechanisms, explicit consent flows, and architectural safeguards that prevent unauthorised tracking and correlation of user activities across services. These technical and organisational measures ensure that the EUDI Wallet not only complies with legal obligations but embeds privacy protection as a fundamental design characteristic.

\subsubsection{Selective Disclosure of Attributes}

Selective disclosure enables users to present only the specific attributes required for a given transaction, withholding all other personal information even when it resides within the same credential. The \ac{ARF} mandates that all Person Identification Data (PID) and Electronic Attestation of Attributes (EAA) credentials support selective disclosure using privacy-preserving formats~\cite{ARF}. Two primary technical mechanisms implement this capability: Selective Disclosure JSON Web Tokens (SD-JWT) for credentials based on the W3C Verifiable Credentials Data Model, and the mobile document (mdoc) format defined in ISO/IEC 18013-5:2021 for CBOR-encoded credentials.

SD-JWT achieves selective disclosure by cryptographically hashing individual claims within a credential separately, allowing the wallet to construct presentations that include only the plaintext values of disclosed attributes alongside the hashes of undisclosed ones. When a Relying Party requests proof of a specific attribute, for example, confirmation that a user is over 18 years of age, the wallet can reveal only the \texttt{age\_over\_18} boolean claim without disclosing the user's exact date of birth, full name, address, or any other personal identifiers contained in the PID~\cite{DocuSign_SelectDisclosure,ISC2}. The Relying Party can cryptographically verify that the disclosed attribute is authentic and has not been tampered with, but cannot access any information the user has chosen to withhold.

Similarly, the ISO/IEC 18013-5 mdoc format structures credentials as a collection of data elements within defined namespaces, enabling fine-grained disclosure control. During proximity presentations using NFC or Bluetooth, the wallet presents only the requested data elements while maintaining cryptographic binding to the issuer's signature. This approach is particularly effective for offline verification scenarios where network connectivity is unavailable, such as age verification at retail points of sale or document checks at border crossings.

The \ac{ARF} further defines specific mechanisms for age verification without date of birth disclosure, leveraging the \texttt{age\_over\_NN} attributes specified in ISO/IEC 18013-5. These derived attributes allow users to prove they meet various age thresholds (e.g., 16, 18, 21) without revealing their precise birthdate, thereby minimising the personal data shared in common identity verification scenarios. This capability directly implements the data minimisation obligation under Article 5(1)(c) GDPR while maintaining the assurance level necessary for regulated activities~\cite{ZKPDiscussion_Recital15,ZKPDiscussion_Recital59}.

\subsubsection{User Consent and Transparency}

The principle of user control over personal data, central to both GDPR and Self-Sovereign Identity paradigms, is embedded throughout the wallet's consent and transparency mechanisms. Article 5a(4) of eIDAS 2.0 mandates that the wallet provide a common dashboard enabling users to view an up-to-date list of Relying Parties with which they have shared data, along with details of all exchanged information~\cite{EU_eIDAS2024}. This dashboard must display, at minimum, the time and date of each transaction, the identity of the counterpart, the personal data requested, and the data actually shared.

Before any credential presentation, the wallet interface must present the user with clear, unambiguous information about what attributes are being requested, by whom, and for what stated purpose~\cite{ISC2,Potential_eudiwallet}. Users must provide explicit consent for each disclosure, with the wallet ensuring that consent is freely given, specific, informed, and unambiguous as required by Article 4(11) and Article 7 GDPR. The \ac{ARF} specifies that wallets must alert users if a Relying Party requests data beyond what it has registered for in the national registry, providing users the option to reject such transactions.

Relying Parties must register their intended uses of the EUDI Wallet with competent authorities in their Member State of establishment, specifying exactly which attributes they will request and the legal or contractual basis for doing so. This registration information is made publicly available online in user-friendly formats, allowing both users and the wallet itself to verify that data requests align with declared purposes. The registration requirement implements accountability obligations under Article 5(2) GDPR and provides transparency about data processing practices before users engage with services~\cite{EU_ARF2024}.

The dashboard also enables users to exercise their rights under GDPR, including the right to request erasure of personal data (Article 17) and the right to report suspected unlawful data processing to competent Data Protection Authorities. By consolidating transaction history, consent records, and data subject rights mechanisms in a single, accessible interface, the wallet operationalises the transparency obligations that underpin trust in personal data processing~\cite{Potential_eudiwallet}.

\subsubsection{Unlinkability and Anti-Tracking Measures}

Beyond selective disclosure and consent management, the \ac{ARF} implements architectural measures to prevent tracking and correlation of user activities across different Relying Parties. Article 5a(16) of eIDAS 2.0 explicitly requires that the wallet prevent attestation providers or Relying Parties from tracking user behaviour and ensure unlinkability~\cite{ZKPDiscussion_Article5a}. Unlinkability means that different transactions performed by the same user cannot be correlated by service providers, thereby preventing the construction of comprehensive user profiles without explicit consent.

The wallet achieves unlinkability through several technical mechanisms. First, credential presentations must not contain persistent identifiers that remain constant across different Relying Parties. Instead, the wallet generates transaction-specific or Relying Party-specific pseudonyms, ensuring that the same user appears with different identifiers to different services. Second, the wallet employs cryptographic proof-of-possession mechanisms that demonstrate control over credentials without revealing long-term private keys, preventing key-based tracking across presentations.

Third, the \ac{ARF} mandates that PID Providers and Attestation Providers must not learn how users employ issued credentials. Article 5a(5) of eIDAS 2.0 prohibits wallets from providing any information to trust service providers about the use of attestations~\cite{EU_eIDAS2024}. This "issuer blindness" prevents even trusted authorities from monitoring citizen interactions with private or public services, reinforcing privacy against surveillance by state actors and institutional service providers alike.

However, achieving perfect unlinkability while maintaining high assurance levels presents practical challenges. Certain high-risk transactions, such as financial services subject to anti-money laundering regulations, border control, or law enforcement investigations, may require linkable identifiers under legal obligations. The \ac{ARF} acknowledges these tensions and provides mechanisms for pseudonymous authentication as the default mode, with full identification reserved for scenarios where legal mandates necessitate it. Users can create and manage multiple pseudonyms, and Relying Parties cannot reject pseudonym-based authentication unless required by law~\cite{EU_ARF2024}.

Moreover, practical implementation of unlinkability depends on broader ecosystem design beyond the wallet itself. If Relying Parties collude to correlate transactions based on timing, disclosed attributes, or network metadata, architectural unlinkability guarantees may be circumvented. The regulatory framework addresses this through Data Protection Impact Assessments (DPIAs) required under Recital 17 of eIDAS 2.0, mandating that Relying Parties assess and mitigate high privacy risks before processing wallet data~\cite{EU_eIDAS2024}. Supervisory authorities must be consulted where DPIAs indicate residual high risks, providing an institutional safeguard complementing technical privacy measures.

\subsection{Interoperability Mechanisms}
\label{subsec:interoperability}

Interoperability, the ability for diverse systems implemented by different Member States, sectors, and providers to exchange and mutually recognise digital credentials, is fundamental to realising the EUDI Wallet's vision of a seamless European digital identity ecosystem. The \ac{ARF} achieves interoperability through adherence to internationally recognised standards for credential formats, protocols for issuance and presentation, and a trust infrastructure that enables cross-border verification without requiring bilateral agreements between all parties. This section evaluates these mechanisms and their role in supporting the wallet's operational requirements.

\subsubsection{Cross-Border Credential Formats}

The \ac{ARF} mandates support for two complementary credential data models: the W3C Verifiable Credentials Data Model 1.1 and the ISO/IEC 18013-5:2021 mobile document (mdoc) format~\cite{EU_ARF2024}. This dual-format approach balances flexibility for diverse use cases with proven interoperability in high-assurance, offline scenarios. The W3C Verifiable Credentials Data Model provides an extensible JSON-based framework suitable for representing a wide range of attestations, from government-issued identity documents to educational diplomas, professional licenses, and sectoral credentials. Its flexibility enables innovation and adaptation to emerging use cases while maintaining a consistent verification model based on cryptographic signatures and decentralised identifiers.

ISO/IEC 18013-5, developed originally for mobile driving licenses (mDL), defines a CBOR-encoded credential structure optimised for constrained environments where bandwidth, storage, and computational resources are limited. The mdoc format has been extensively tested and deployed in multiple jurisdictions worldwide, providing a mature foundation for the EUDI Wallet's proximity presentation requirements. Its support for offline verification, enabling credential validation without internet connectivity, is critical for use cases such as border control, retail age verification, and access to physical spaces where network reliability cannot be guaranteed.

The \ac{ARF} specifies that PID attestations and Qualified Electronic Attestations of Attributes (QEAA) must be issued in accordance with both data models: using Selective Disclosure JSON Web Tokens (SD-JWT) for W3C-based encoding and ISO/IEC 18013-5 mdoc format for CBOR-based encoding. This dual issuance ensures that credentials can be presented in contexts favouring either remote online verification or proximity offline scenarios, maximising usability across the diverse landscape of European digital services~\cite{EU_ARF2024}.

To support semantic interoperability, the \ac{ARF} introduces attestation rulebooks that define the structure, mandatory and optional attributes, data types, and namespace identifiers for specific credential types. The PID Rulebook, for example, specifies the core attributes that all Member States must support for Person Identification Data, along with mechanisms for national extensions that accommodate legal or administrative specificities. This controlled vocabulary approach reduces ambiguity in credential interpretation and enables automated processing by Relying Parties without requiring manual mapping or translation between national implementations~\cite{Finextra_SSI}.

\subsubsection{Protocol Flows for Issuance and Presentation}

Standardised protocols for credential issuance and presentation are essential for interoperability between Wallet Instances, PID Providers, Attestation Providers, and Relying Parties. The \ac{ARF} specifies distinct protocol families depending on the interaction model and technical context.

For remote online credential issuance, the \ac{ARF} mandates the use of OpenID for Verifiable Credential Issuance (OpenID4VCI), an extension of the OAuth 2.0 and OpenID Connect frameworks designed specifically for issuing verifiable credentials to digital wallets~\cite{EU_ARF2024}. OpenID4VCI defines how a wallet requests credentials from a PID Provider or Attestation Provider, how the issuer authenticates the user and verifies their eligibility, and how cryptographic holder binding is established to ensure credentials cannot be transferred to unauthorised parties. The protocol supports both synchronous issuance, where credentials are delivered immediately upon successful authentication, and deferred issuance, where background verification processes complete before credential delivery.

For remote online credential presentation, the \ac{ARF} specifies OpenID for Verifiable Presentations (OpenID4VP), which enables Relying Parties to request specific attributes from a wallet and receive cryptographic proofs of credential authenticity and holder control~\cite{EU_ARF2024}. OpenID4VP leverages presentation exchange protocols that allow Relying Parties to express fine-grained attribute requests, enabling selective disclosure aligned with data minimisation requirements. The protocol includes mechanisms for mutual authentication, ensuring that both the wallet and the Relying Party can verify each other's legitimacy before exchanging sensitive information.

For proximity presentation scenarios, the \ac{ARF} adopts the ISO/IEC 18013-5 device engagement and data retrieval protocols, which define how a secure communication channel is established between the wallet and a verifier using NFC, Bluetooth Low Energy, or QR codes~\cite{EU_ARF2024}. These protocols support offline verification, where the verifier validates credential signatures and revocation status using locally cached issuer certificates and cryptographic material, without requiring real-time network access. The proven deployment of ISO/IEC 18013-5 in mobile driving license programmes across multiple countries provides confidence in its reliability for high-assurance offline verification scenarios.

The combination of OpenID-based protocols for online interactions and ISO/IEC 18013-5 protocols for proximity use cases ensures that the EUDI Wallet can operate across the full spectrum of digital identity transactions, from remote authentication to e-government services to in-person verification at border checkpoints or retail establishments~\cite{Finextra_SSI}.

\subsubsection{Trust Infrastructure and Recognition}

Cross-border interoperability depends not only on common data formats and protocols but also on a trust infrastructure that enables verifiers to validate credentials issued by providers in other Member States. The \ac{ARF} establishes a hierarchical trust model anchored through qualified trust service providers operating under eIDAS 2.0 supervision, trust registries maintained at national and European levels, and mechanisms for certificate validation and revocation checking~\cite{EU_ARF2024,PortoThesis}.

For ISO/IEC 18013-5-based credentials, trust is established through an X.509 Public Key Infrastructure (PKI) where each PID Provider and Attestation Provider operates as a certificate authority with its own root certificate. National trust registries publish issuer metadata, certificate chains, and revocation information, enabling Relying Parties to retrieve the cryptographic material necessary to verify credential signatures and validate issuer authenticity. The trust registries themselves are discoverable through standardised protocols, and their integrity is protected through cryptographic signatures from national supervisory authorities~\cite{PortoThesis,Finextra_SSI}.

For W3C-based credentials using SD-JWT, the \ac{ARF} specifies trust frameworks based on OpenID Federation, which provides a distributed trust model enabling entities to establish trust relationships through cryptographic proofs and metadata exchanges. OpenID Federation supports hierarchical trust chains where intermediate entities vouch for leaf entities, enabling scalable trust propagation across the EU ecosystem without requiring pre-negotiated bilateral agreements. Trust anchors at the European level, maintained by the European Commission or designated EU-wide trust service providers, provide ultimate roots of trust that Member States and sectoral services can rely upon~\cite{EU_ARF2024}.

The trust infrastructure also incorporates mechanisms for certificate and credential revocation, ensuring that compromised or expired credentials cannot be used for fraudulent purposes. Revocation status can be checked through Online Certificate Status Protocol (OCSP) queries, Certificate Revocation Lists (CRLs), or more privacy-preserving mechanisms such as status list credentials that enable batch revocation checking without revealing which specific credentials are being validated. The \ac{ARF} requires that Wallet Instances check revocation status before presenting credentials to Relying Parties, and that Relying Parties verify revocation status as part of their credential validation process~\cite{EU_ARF2024}.

Crucially, the legal framework of eIDAS 2.0 mandates mutual recognition of credentials issued under the regulation, meaning that a PID issued in one Member State must be accepted by Relying Parties in all other Member States~\cite{EU_eIDAS2024,Finextra_SSI}. This legal obligation, combined with the technical interoperability mechanisms provided by the \ac{ARF}, eliminates historical fragmentation where national eID schemes operated in isolation and were not recognised across borders. The attestation rulebooks and schema catalogues published by the European Commission provide additional guidance, ensuring that issuers and verifiers interpret credential attributes consistently and that sectoral use cases can be supported through standardised credential types.

The Large-Scale Pilots (LSPs) currently underway across Europe, including the POTENTIAL consortium involving 19 Member States and over 140 partners, provide real-world validation of these interoperability mechanisms. Pilot participants are testing credential issuance, presentation, and verification flows across diverse implementations, identifying integration challenges and refining specifications to ensure seamless operation when the EUDI Wallet is mandated for all Member States by the end of 2026~\cite{EU_ARF2024}.
% % % % % % % % % % % % % % % % % % % % %
%                PILOT DESIGN
% % % % % % % % % % % % % % % % % % % % %
\section{Pilot Test Implementation}

To evaluate the practical implementation and operational workflow of an EUDI Wallet based on the eIDAS 2.0 framework \cite{eidas2_regulation}, we developed a comprehensive pilot test. The eIDAS 2.0 regulation, adopted by the European Parliament on 29 February 2024 and entered into force on 20 May 2024, mandates all EU member states to offer their citizens EUDI Wallets by the beginning of 2027. This pilot simulates a real-world scenario involving three fundamental ecosystem components as defined in the EUDI Wallet Architecture and Reference Framework (ARF) \cite{eudi_arf}: a User Wallet, an Issuer, and a Verifier.

The scenario demonstrates the complete lifecycle of a digital academic credential: a university (Issuer) issues a diploma, which is securely stored in the student's wallet, and later presented to an employer or institution (Verifier) to prove academic qualifications. All components were built using EU reference codebases \cite{eudi_reference_implementation}, adapted specifically for this demonstration.

% -----------------------------------------------------------
\subsection{System Architecture and Configuration}

The entire architecture was deployed on a single Windows 11 machine, allowing for complete local testing of the ecosystem while maintaining the distributed nature of the components as described in the ARF \cite{eudi_arf}.

\subsubsection{User Wallet Configuration}
The User Wallet implementation leverages the official Android reference application from the \texttt{eudi-app-android-wallet-ui} repository \cite{eudi_android_wallet}. We used Android Studio both for source code modifications and to run the application through its integrated device emulator. This approach provided a realistic mobile environment without requiring physical hardware during development and testing phases. The wallet implements the core functionalities mandated by Article 5a of the eIDAS 2.0 regulation \cite{eidas2_regulation}.

\subsubsection{Issuer Service Setup}
The Issuer service runs as a Flask-based web application developed in Python 3.11. Using Visual Studio Code as the development environment, we configured the service to operate on \texttt{localhost:5000}, making it accessible to the User Wallet for credential issuance requests. The implementation draws from the official \texttt{eudi-srv-web-issuing-eudiw-py} repository \cite{eudi_issuer_service}, with all required dependencies managed through a \texttt{requirements.txt} file. The issuer follows the OpenID for Verifiable Credential Issuance (OpenID4VCI) protocol \cite{openid4vci} as specified in the ARF.

\subsubsection{Verifier Service Architecture}
The Verifier operates as a RESTful backend implementing the OpenID for Verifiable Presentations (OpenID4VP) 1.0 protocol \cite{openid4vp_spec}, serving as the trusted Relying Party endpoint as defined in Article 5b of the eIDAS 2.0 regulation \cite{eidas2_regulation}. OpenID4VP defines a mechanism on top of OAuth 2.0 that enables presentation of Verifiable Credentials as Verifiable Presentations. Built with Angular, it exposes two distinct API surfaces as prescribed by the ARF \cite{eudi_arf}:

The \textbf{Verifier API} manages the verification lifecycle, handling transaction initialization for Self-Issued OpenID Provider v2 (SIOPv2), OpenID4VP, or hybrid authentication requests \cite{openid4vp_spec}, and processing both successful and error responses from the User Wallet.

The \textbf{Wallet API} facilitates bidirectional communication with the User Wallet. It provides a \textit{Get Requested Object} endpoint that delivers metadata via JWT-secured authorization, and a \textit{Post to Wallet} endpoint that enables the Wallet to generate authorization tokens for subsequent data presentation requests.

% -----------------------------------------------------------
\subsection{End-to-End Workflow}

The pilot test follows a logical sequence that mirrors real-world credential usage within the EUDI Wallet ecosystem \cite{eudi_arf}:

\begin{enumerate}
    \item The user navigates to the Issuer's web portal and initiates a request for an academic diploma credential conforming to the W3C Verifiable Credentials Data Model \cite{w3c_vc_data_model}.
    
    \item The Issuer authenticates the user through established credentials (such as institutional username and password) and verifies their eligibility to receive the diploma credential based on academic records, following the attestation issuance procedures defined in the ARF \cite{eudi_arf}.
    
    \item Upon successful verification, the Issuer constructs a Verifiable Credential containing the diploma data according to the W3C standard \cite{w3c_vc_data_model}, cryptographically signs it with its private key, and transmits it securely to the User Wallet using the OpenID4VCI protocol \cite{openid4vci}.
    
    \item The User Wallet receives and stores the credential in its secure storage mechanism, leveraging the Wallet Secure Cryptographic Device (WSCD) as specified in the ARF \cite{eudi_arf}, making it available for future presentations.
    
    \item When the user needs to prove their academic qualification, they initiate a verification session with the Verifier, following the attestation presentation flows defined in the ARF \cite{eudi_arf}.
    
    \item The Verifier generates a QR code containing the presentation request parameters conforming to the OpenID4VP protocol \cite{openid4vp_spec}, which the user scans using their Wallet application.
    
    \item The Wallet retrieves the associated metadata from the verification request, understanding what information the Verifier requires based on the presentation definition or DCQL query \cite{openid4vp_spec}.
    
    \item The user reviews the request and selects the appropriate credential—in this case, the academic diploma—exercising their right to control which data is shared as guaranteed by the eIDAS 2.0 framework \cite{eidas2_regulation}.
    
    \item The Wallet constructs a Verifiable Presentation tailored to the Verifier's requirements, following the W3C Verifiable Credentials Data Model \cite{w3c_vc_data_model} and the OpenID4VP protocol \cite{openid4vp_spec}.
    
    \item The Verifier performs comprehensive validation as mandated by the ARF \cite{eudi_arf}, checking cryptographic signatures, verifying credential integrity, confirming the Issuer's trust status within the EUDI Trust Infrastructure \cite{eudi_trust_framework}, validating expiration and issuance timestamps, and ensuring full conformance with the OpenID4VP protocol \cite{openid4vp_spec}.
    
    \item Upon successful validation of all security and trust parameters, the Verifier provides confirmation to the user, completing the verification process in accordance with the relying party requirements specified in Article 5b of the eIDAS 2.0 regulation \cite{eidas2_regulation}.
\end{enumerate}

% -----------------------------------------------------------
\subsection{Technical Deep Dive}

This section explores the technical implementation details, security mechanisms, and protocol-level operations of each component as defined by the ARF \cite{eudi_arf} and relevant technical standards.

\subsubsection{Issuer: Credential Generation and Cryptographic Signing}

The Issuer orchestrates several critical operations to produce a secure, verifiable credential compliant with both the W3C Verifiable Credentials Data Model \cite{w3c_vc_data_model} and the OpenID4VCI protocol \cite{openid4vci}.

\paragraph{Data Processing and Structuring}  
When a request arrives, the Issuer first authenticates the user and retrieves the relevant academic records from its internal database. It then transforms this institutional data into the standardized W3C Verifiable Credential data model, ensuring interoperability with any compliant wallet or verifier. This transformation maps diploma attributes—such as degree type, field of study, graduation date, and honors—into the structured credential format. The credential structure includes metadata fields such as \texttt{@context}, \texttt{type}, \texttt{issuer}, \texttt{issuanceDate}, \texttt{credentialSubject}, and \texttt{proof} as specified in the W3C standard \cite{w3c_vc_data_model}.

\paragraph{Cryptographic Operations}  
Security is established through asymmetric cryptography conforming to the security requirements defined in the ARF \cite{eudi_arf}. The Issuer signs the credential using its private key, typically employing ECDSA (Elliptic Curve Digital Signature Algorithm) or EdDSA (Edwards-curve Digital Signature Algorithm) algorithms. The corresponding public key is published through the EUDI Trust Infrastructure \cite{eudi_trust_framework}, allowing any verifier to validate the signature's authenticity. Each credential includes a comprehensive \texttt{proof} block containing the signature value, a key identifier (KID) referencing the specific signing key, the algorithm used, an issuance timestamp, and a reference to the credential schema as prescribed by the W3C Verifiable Credentials Data Model \cite{w3c_vc_data_model}.

\paragraph{Secure Transmission}
The signed credential is transmitted to the User Wallet over HTTPS, ensuring confidentiality and integrity during transit. Following the OpenID4VCI protocol \cite{openid4vci}, the credential may be packaged as either a JWT-VC (JSON Web Token format) or a COSE/CBOR object, both widely supported standards in the digital identity space and accepted formats within the EUDI Wallet ecosystem \cite{eudi_arf}.

\subsubsection{User Wallet: Secure Storage and Presentation Logic}

The Wallet serves as the user's personal credential repository and presentation agent, requiring robust security at every layer as mandated by the ARF \cite{eudi_arf}.

\paragraph{Storage Security Architecture}
The wallet implements a Cryptographic Keys Management System responsible for managing and storing cryptographic information, including private keys generated during the credential issuance process. Credentials reside in the Android Keystore, which provides hardware-backed encryption on supported devices. Critically, the user's private keys never leave the device and cannot be extracted or backed up, ensuring compliance with the WSCD requirements defined in the ARF \cite{eudi_arf}. Accessing stored credentials requires active user consent, typically enforced through biometric authentication or PIN entry, preventing unauthorized access even if the device is compromised.

\paragraph{Credential Management}
The Wallet maintains complete Verifiable Credentials as received from Issuers, preserving all claims and metadata in accordance with the W3C Verifiable Credentials Data Model \cite{w3c_vc_data_model}. When a presentation request arrives via the OpenID4VP protocol \cite{openid4vp_spec}, the Wallet parses the metadata—often structured as JWT or Selective Disclosure JWT (SD-JWT)—to understand exactly what the Verifier requires. The Attestation Exchange Protocol defines how to request and present credentials in a secure and privacy-preserving fashion. It then constructs a Verifiable Presentation containing only the necessary attributes, implementing the principle of data minimization as guaranteed by the eIDAS 2.0 regulation \cite{eidas2_regulation}.

\paragraph{Presentation Security}
Each Verifiable Presentation is signed with the user's private key, cryptographically binding it to the wallet holder. For credentials that support selective disclosure, the Wallet can reveal only requested attributes while keeping others hidden, a key privacy feature of the EUDI Wallet ecosystem \cite{eudi_arf}. To prevent replay attacks, each presentation incorporates unique nonce and state parameters provided by the Verifier as specified in the OpenID4VP protocol \cite{openid4vp_spec}, ensuring the presentation cannot be intercepted and reused.

\subsubsection{Verifier: Multi-Layer Validation Framework}

The Verifier implements a defense-in-depth approach, performing checks at the cryptographic, structural, trust, and protocol levels as mandated by Article 5b of the eIDAS 2.0 regulation \cite{eidas2_regulation} and the ARF \cite{eudi_arf}.

\paragraph{Initial Processing}
The Verifier receives the Verifiable Presentation through an OpenID4VP channel—either as a redirect or POST request. It extracts the embedded Verifiable Credential(s) and validates the structural integrity, ensuring compliance with the expected schemas defined in the W3C Verifiable Credentials Data Model \cite{w3c_vc_data_model} and data formats specified in the ARF \cite{eudi_arf}.

\paragraph{Cryptographic Verification}
Both the Verifiable Presentation and the underlying Verifiable Credential undergo signature verification following the cryptographic requirements specified in the ARF \cite{eudi_arf}. The Verifier retrieves the Issuer's public key from trusted metadata sources within the EUDI Trust Infrastructure \cite{eudi_trust_framework} and confirms that the signatures are valid and unaltered. It also validates temporal parameters as defined in the OpenID4VP protocol \cite{openid4vp_spec}, checking that nonce values match, state parameters are correct, credentials haven't expired, and issuance dates are reasonable.

\paragraph{Trust Framework Integration}
Beyond cryptographic validity, the Verifier must establish trust in the Issuer through the EUDI Trust Infrastructure \cite{eudi_trust_framework}. It confirms that the Issuer is a recognized, trusted entity within the EUDI ecosystem, validates that the credential type and format are permitted for the requested purpose, and checks revocation status against any configured revocation lists or status endpoints as specified in the ARF \cite{eudi_arf}.

\paragraph{Authorization Decision}
After completing all validation layers mandated by the eIDAS 2.0 regulation \cite{eidas2_regulation} and the ARF \cite{eudi_arf}, the Verifier makes its final determination. Success results in a confirmation message delivered to the user. Failure triggers a standardized error response conforming to the OpenID4VP protocol \cite{openid4vp_spec}—such as \texttt{invalid\_signature}, \texttt{expired\_credential}, or \texttt{issuer\_not\_trusted}—providing clear feedback about why the verification failed while maintaining security by not revealing sensitive details to potential attackers.



% % % % % % % % % % % % % % % % % % % % %
%               CONCLUSION
% % % % % % % % % % % % % % % % % % % % %
\section{Conclusion}
\label{sec:conclusion}

% TODO: Sintetizar:
%  - o que foi aprendido com a avaliação de componentes do ARF;
%  - como o piloto ilustra, na prática, a aplicação desses componentes;
%  - limitações identificadas (por exemplo, complexidade, dependência de certificação, desafios de usabilidade);
%  - possíveis extensões (mais casos de uso, maior automatização, integração com outros sistemas).

This report analysed how specific components of the EUDI \ac{ARF} support secure and privacy-preserving digital identity transactions and proposed a high-level pilot design to illustrate their application in practice.
By structuring the discussion around identity verification, data minimisation, and interoperability, we highlighted the architectural strengths of the framework and the main trade-offs involved in real-world deployments.
The pilot design showed how these components can be orchestrated in a concrete use case, offering a starting point for further technical refinement and implementation work.

% % % % % % % % % % % % % % % % % % % % %
%           ACKNOWLEDGMENTS (OPTIONAL)
% % % % % % % % % % % % % % % % % % % % %
\section*{Acknowledgments}

% Opcional: podes manter, adaptar ou remover.
The authors would like to acknowledge the work of the European Commission and the Member State experts involved in the definition of the EUDI Architecture and Reference Framework, as well as the broader research and standards communities working on digital identity and privacy-enhancing technologies.

% % % % % % % % % % % % % % % % % % % % %
%               BIBLIOGRAPHY
% % % % % % % % % % % % % % % % % % % % %
\bibliographystyle{ACM-Reference-Format}
\bibliography{refs}

\end{document}